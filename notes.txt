get rid of malloc and frees and use arenas and other options
refactor error handling

fix resizing of window
fixing cleanup when exiting program
